<!--
    // https://www.gamedev.net/articles/programming/graphics/the-basics-of-glsl-40-shaders-r2861
    // https://threejs.org/docs/index.html#api/en/materials/ShaderMaterial
-->
<script type="x-shader/x-vertex" id="terrainVertex">
    varying vec2 vUv;
    varying float Thickness;


    uniform vec4 LightPosition; // Light position in eye coords.
    uniform vec4 Position; // Light position in eye coords.
    // MATERIAL
    uniform vec3 Ka; // Ambient reflectivity
    uniform vec3 Kd; // Diffuse reflectivity
    uniform vec3 Ks; // Specular reflectivity
    uniform float Shininess; // Specular shininess factor
    // LIGHT
    uniform vec3 La; // Ambient light intensity
    uniform vec3 Ld; // Diffuse light intensity
    uniform vec3 Ls; // Specular light intensity


    varying vec3 LightIntensity;

    void main() {
        vUv = uv;
        Thickness = 0.003;
        /*

        vec3 tnorm = normalize( normalMatrix * normal);
        vec4 eyeCoords = modelViewMatrix * vec4(position,1.0);
        vec3 s = normalize(vec3(LightPosition - eyeCoords));
        vec3 v = normalize(-eyeCoords.xyz);
        vec3 r = reflect( -s, tnorm ); // TODO reflect does not work
        vec3 ambient = La * Ka;
        float sDotN = max( dot(s,tnorm), 0.0 );
        vec3 diffuse = Ld * Kd * sDotN;
        vec3 spec = vec3(0.0);
        if( sDotN > 0.0 ) //TODO just one line?
        spec = Ls * Ks * pow( max( dot(r,v), 0.0 ), Shininess );
                // */
        LightIntensity = vec3(1.0,1.0,1.0);//ambient + diffuse + spec;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }
</script>

<!--
<script type="x-shader/x-vertex" id="terrainVertex">
    uniform float heightMap[2]; // can only store arrays to smaller size // TODO not used yet
    uniform vec4 LightPosition; // Light position in eye coords.
    uniform vec3 Kd; // Diffuse reflectivity
    uniform vec3 Ld; // Light source intensity
    //uniform mat4 ModelViewMatrix;
    //uniform mat3 NormalMatrix;
    //uniform mat4 ProjectionMatrix;
    //uniform mat4 MVP; // Projection * ModelView
    uniform float Thickness;


    varying vec2 vUv;

    void main() {
        //resultion = 5.0;
        mat4 normalMatrix = view * transpose(inverse(model));
        vUv = uv;
        vec3 tnorm = normalize( NormalMatrix * VertexNormal);
        vec4 eyeCoords = ModelViewMatrix * vec4(VertexPosition,1.0);
        vec3 s = normalize(vec3(Light.Position - eyeCoords));
        vec3 v = normalize(-eyeCoords.xyz);
        vec3 r = reflect( -s, tnorm );
        vec3 ambient = Light.La * Material.Ka;
        float sDotN = max( dot(s,tnorm), 0.0 );
        vec3 diffuse = Light.Ld * Material.Kd * sDotN;
        vec3 spec = vec3(0.0);
        if( sDotN > 0.0 ) //TODO just one line?
        spec = Light.Ls * Material.Ks * pow( max( dot(r,v), 0.0 ), Material.Shininess );
        LightIntensity = ambient + diffuse + spec;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }
</script>


-->